(this["webpackJsonpclose-your-eyes"]=this["webpackJsonpclose-your-eyes"]||[]).push([[0],{18:function(e,t,a){e.exports=a(26)},26:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),r=a(8),s=a.n(r),c=a(1),o=a(2);function h(){var e=Object(c.a)(["\n font-size: large;\n"]);return h=function(){return e},e}function u(){var e=Object(c.a)(["\n animation: App-logo-spin infinite 20s linear;\n height: 80px;\n @keyframes App-logo-spin {\n   from { transform: rotate(0deg); }\n   to { transform: rotate(360deg); }\n }\n"]);return u=function(){return e},e}function l(){var e=Object(c.a)(["\n   font-size: 1.5em;\n"]);return l=function(){return e},e}function d(){var e=Object(c.a)(["\n background-color: #222;\n height: 150px;\n padding: 20px;\n color: white;\n"]);return d=function(){return e},e}function v(){var e=Object(c.a)(["\n text-align: center;\n"]);return v=function(){return e},e}var g=o.b.div(v()),f=(o.b.header(d()),o.b.h1(l()),o.b.img(u()),o.b.p(h()),a(6)),m=a.n(f),b=a(12),p=a(13),y=a(16),_=a(14),k=a(3),F=a(17);function w(){var e=Object(c.a)([""]);return w=function(){return e},e}function O(){var e=Object(c.a)([""]);return O=function(){return e},e}function S(){var e=Object(c.a)([""]);return S=function(){return e},e}function M(){var e=Object(c.a)(["\n\ttext-align: center;\n"]);return M=function(){return e},e}var j=o.b.div(M()),E=o.b.button(S()),T=o.b.canvas(O()),A=o.b.p(w()),C=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(y.a)(this,Object(_.a)(t).call(this,e))).state={sdkLoaded:!1,width:320,height:240,threshold:15,licenseName:"606-555-833-692-564-758-653-442-720-253-644.vlc",licenseURL:"lib/606-555-833-692-564-758-653-442-720-253-644.vlc"},a.$canvas=n.a.createRef(),a.$status=n.a.createRef(),a._loaded=a._loaded.bind(Object(k.a)(a)),a._initStream=a._initStream.bind(Object(k.a)(a)),a._canPlayStream=a._canPlayStream.bind(Object(k.a)(a)),a._tick=a._tick.bind(Object(k.a)(a)),window.callbackDownload=a._loaded,a}return Object(F.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.visageModule=window.VisageModule({onRuntimeInitialized:this._loaded,locateFile:function(e){return"lib/"+e}});this.visageModule.preRun.push((function(){e.visageModule.FS_createPreloadedFile("/","FFT-Ultra.cfg","lib/Facial Features Tracker - Ultra.cfg",!0,!1),e.visageModule.FS_createPreloadedFile("/","FFT-High.cfg","lib/Facial Features Tracker - High.cfg",!0,!1),e.visageModule.FS_createPreloadedFile("/","FFT-Low.cfg","lib/Facial Features Tracker - Low.cfg",!0,!1),e.visageModule.FS_createPreloadedFile("/",e.state.licenseName,e.state.licenseURL,!0,!1,(function(){}),(function(){console.error("Loading License Failed!")}))}))}},{key:"_loaded",value:function(){this.visageModule.initializeLicenseManager(this.state.licenseName),this.m_Tracker=new this.visageModule.VisageTracker("FFT-High.cfg"),this.faceDataArray=new this.visageModule.FaceDataVector,this.faceData=new this.visageModule.FaceData,this.faceDataArray.push_back(this.faceData),this.mWidth=this.$canvas.current.width,this.mHeight=this.$canvas.current.height,this.ppixels=this.visageModule._malloc(this.mWidth*this.mHeight*4),this.pixels=new Uint8ClampedArray(this.visageModule.HEAPU8.buffer,this.ppixels,this.mWidth*this.mHeight*4),this.canvasContext=this.$canvas.current.getContext("2d"),this.eyesClosed=!1,this.eyesClosedCounter=0,this.setState({sdkLoaded:!0})}},{key:"_initStream",value:function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,this.$video=document.createElement("video"),t.prev=2,t.next=5,m.a.awrap(navigator.mediaDevices.getUserMedia({video:!0,audio:!1}));case 5:e=t.sent,this.$video.addEventListener("canplay",this._canPlayStream),this.$video.setAttribute("muted",!0),this.$video.setAttribute("playsinline",!0),this.$video.srcObject=e,this.$video.load(),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),this._errorStream(t.t0);case 16:case"end":return t.stop()}}),null,this,[[2,13]])}},{key:"_errorStream",value:function(e){e&&console.error(e)}},{key:"_canPlayStream",value:function(e){this.startTracking=!0,this.draw=!0,this.$video.removeEventListener("canplay",this._canPlayStream),this.$video.play(),this.$canvas.current.width=this.state.width,this.$canvas.current.height=this.state.height,this.mWidth=this.state.width,this.mHeight=this.state.height,this._tick()}},{key:"_tick",value:function(){window.requestAnimationFrame(this._tick),this.canvasContext.drawImage(this.$video,0,0,this.mWidth,this.mHeight),this.imageData=this.canvasContext.getImageData(0,0,this.mWidth,this.mHeight).data;for(var e=0;e<this.imageData.length;e+=4)this.pixels[e]=this.imageData[e];if(this.trackerReturnState=this.m_Tracker.track(this.mWidth,this.mHeight,this.ppixels,this.faceDataArray,this.visageModule.VisageTrackerImageFormat.VISAGE_FRAMEGRABBER_FMT_RGBA.value,this.visageModule.VisageTrackerOrigin.VISAGE_FRAMEGRABBER_ORIGIN_TL.value),this.trackerReturnState[0]===this.visageModule.VisageTrackerStatus.TRACK_STAT_OK.value){var t=this.faceData.getEyeClosure();0===t[0]&&0===t[1]?(this.eyesClosedCounter++,this.eyesClosedCounter>this.state.threshold&&(this.eyesClosed=!0)):this.eyesClosed=!1}this.$status.current.innerHTML=this.eyesClosed.toString()}},{key:"render",value:function(){return n.a.createElement(j,null,n.a.createElement(A,{ref:this.$status}),n.a.createElement(T,{ref:this.$canvas,width:this.state.width,height:this.state.height}),n.a.createElement(j,null,this.state.sdkLoaded&&n.a.createElement(E,{onClick:this._initStream},"Start")))}}]),t}(n.a.Component);function $(){var e=Object(c.a)([""]);return $=function(){return e},e}function x(){var e=Object(c.a)(["\n\tbody {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tfont-family: sans-serif;\n\t}\n"]);return x=function(){return e},e}var R=Object(o.a)(x());o.b.button($());var D=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(R,null),n.a.createElement(g,null,n.a.createElement(C,null)))};s.a.render(n.a.createElement(D,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.b175f065.chunk.js.map