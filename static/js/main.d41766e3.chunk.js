(this["webpackJsonpclose-your-eyes"]=this["webpackJsonpclose-your-eyes"]||[]).push([[0],{18:function(t,e,a){t.exports=a(26)},26:function(t,e,a){"use strict";a.r(e);var i=a(0),n=a.n(i),r=a(8),s=a.n(r),c=a(1),o=a(2);function h(){var t=Object(c.a)(["\n font-size: large;\n"]);return h=function(){return t},t}function u(){var t=Object(c.a)(["\n animation: App-logo-spin infinite 20s linear;\n height: 80px;\n @keyframes App-logo-spin {\n   from { transform: rotate(0deg); }\n   to { transform: rotate(360deg); }\n }\n"]);return u=function(){return t},t}function l(){var t=Object(c.a)(["\n   font-size: 1.5em;\n"]);return l=function(){return t},t}function d(){var t=Object(c.a)(["\n background-color: #222;\n height: 150px;\n padding: 20px;\n color: white;\n"]);return d=function(){return t},t}function v(){var t=Object(c.a)(["\n text-align: center;\n"]);return v=function(){return t},t}var g=o.b.div(v()),m=(o.b.header(d()),o.b.h1(l()),o.b.img(u()),o.b.p(h()),a(6)),f=a.n(m),b=a(12),p=a(13),y=a(16),_=a(14),k=a(3),w=a(17);function F(){var t=Object(c.a)([""]);return F=function(){return t},t}function O(){var t=Object(c.a)([""]);return O=function(){return t},t}function S(){var t=Object(c.a)([""]);return S=function(){return t},t}var M=o.b.button(S()),j=o.b.canvas(O()),A=o.b.div(F()),E=function(t){function e(t){var a;return Object(b.a)(this,e),(a=Object(y.a)(this,Object(_.a)(e).call(this,t))).state={sdkLoaded:!1,width:320,height:240,threshold:15,licenseName:"606-555-833-692-564-758-653-442-720-253-644.vlc",licenseURL:"lib/606-555-833-692-564-758-653-442-720-253-644.vlc"},a.$canvas=n.a.createRef(),a.$status=n.a.createRef(),a._loaded=a._loaded.bind(Object(k.a)(a)),a._initStream=a._initStream.bind(Object(k.a)(a)),a._canPlayStream=a._canPlayStream.bind(Object(k.a)(a)),a._tick=a._tick.bind(Object(k.a)(a)),window.callbackDownload=a._loaded,a}return Object(w.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.visageModule=window.VisageModule({onRuntimeInitialized:this._loaded,locateFile:function(t){return"lib/"+t}});this.visageModule.preRun.push((function(){t.visageModule.FS_createPreloadedFile("/","FFT-High.cfg","lib/Facial Features Tracker - High.cfg",!0,!1),t.visageModule.FS_createPreloadedFile("/","FFT-Low.cfg","lib/Facial Features Tracker - Low.cfg",!0,!1),t.visageModule.FS_createPreloadedFile("/",t.state.licenseName,t.state.licenseURL,!0,!1,(function(){}),(function(){console.error("Loading License Failed!")}))}))}},{key:"_loaded",value:function(){this.visageModule.initializeLicenseManager(this.state.licenseName),this.m_Tracker=new this.visageModule.VisageTracker("FFT-Low.cfg"),this.faceDataArray=new this.visageModule.FaceDataVector,this.faceData=new this.visageModule.FaceData,this.faceDataArray.push_back(this.faceData),this.mWidth=this.$canvas.current.width,this.mHeight=this.$canvas.current.height,this.ppixels=this.visageModule._malloc(this.mWidth*this.mHeight*4),this.pixels=new Uint8ClampedArray(this.visageModule.HEAPU8.buffer,this.ppixels,this.mWidth*this.mHeight*4),this.canvasContext=this.$canvas.current.getContext("2d"),this.eyesClosed=!1,this.eyesClosedCounter=0,this.setState({sdkLoaded:!0})}},{key:"_initStream",value:function(){var t;return f.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,this.$video=document.createElement("video"),e.prev=2,e.next=5,f.a.awrap(navigator.mediaDevices.getUserMedia({video:!0,audio:!1}));case 5:t=e.sent,this.$video.addEventListener("canplay",this._canPlayStream),this.$video.setAttribute("loop",!1),this.$video.setAttribute("muted",!0),this.$video.setAttribute("autoplay",!1),this.$video.setAttribute("playsinline",!0),this.$video.srcObject=t,this.$video.load(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),this._errorStream(e.t0);case 18:case"end":return e.stop()}}),null,this,[[2,15]])}},{key:"_errorStream",value:function(t){t&&console.error(t)}},{key:"_canPlayStream",value:function(t){this.startTracking=!0,this.draw=!0,this.$video.removeEventListener("canplay",this._canPlayStream),this.$video.play(),this.$canvas.current.width=this.state.width,this.$canvas.current.height=this.state.height,this.mWidth=this.state.width,this.mHeight=this.state.height,this._tick()}},{key:"_tick",value:function(){window.requestAnimationFrame(this._tick),this.canvasContext.drawImage(this.$video,0,0,this.mWidth,this.mHeight),this.imageData=this.canvasContext.getImageData(0,0,this.mWidth,this.mHeight).data;for(var t=0;t<this.imageData.length;t+=4)this.pixels[t]=this.imageData[t];if(this.trackerReturnState=this.m_Tracker.track(this.mWidth,this.mHeight,this.ppixels,this.faceDataArray,this.visageModule.VisageTrackerImageFormat.VISAGE_FRAMEGRABBER_FMT_RGBA.value,this.visageModule.VisageTrackerOrigin.VISAGE_FRAMEGRABBER_ORIGIN_TL.value),this.trackerReturnState[0]===this.visageModule.VisageTrackerStatus.TRACK_STAT_OK.value){var e=this.faceData.getEyeClosure();0===e[0]&&0===e[1]?(this.eyesClosedCounter++,this.eyesClosedCounter>this.state.threshold&&(this.eyesClosed=!0)):this.eyesClosed=!1}this.$status.current.innerHTML=this.eyesClosed.toString()}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,"Status: ",n.a.createElement(A,{ref:this.$status}),this.state.sdkLoaded&&n.a.createElement(M,{onClick:this._initStream},"Start"),n.a.createElement(j,{ref:this.$canvas,width:this.state.width,height:this.state.height}))}}]),e}(n.a.Component);function $(){var t=Object(c.a)([""]);return $=function(){return t},t}function C(){var t=Object(c.a)(["\n\tbody {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t\tfont-family: sans-serif;\n\t}\n"]);return C=function(){return t},t}var T=Object(o.a)(C());o.b.button($());var x=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(T,null),n.a.createElement(g,null,n.a.createElement(E,null)))};s.a.render(n.a.createElement(x,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.d41766e3.chunk.js.map